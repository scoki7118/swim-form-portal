# user_portal.py
import streamlit as st
from datetime import datetime
import importlib
from ui_settings import ui_settings_panel

PAGES = {
    "ğŸ’¤ ãŠä¼‘ã¿é€£çµ¡": "user_pages.absent",
    "ğŸ” æŒ¯æ›¿ç”³è¾¼": "user_pages.transfer",
    "ğŸ”§ ã‚³ãƒ¼ã‚¹å¤‰æ›´": "user_pages.course_change",
    "ğŸ’¬ æ‹…å½“è€…ã¸é€£çµ¡": "user_pages.contact",
}

def main():
    st.set_page_config(page_title="ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ã‚¿ãƒ«", layout="wide", initial_sidebar_state="collapsed")
    ui_settings_panel()  # ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã«ã‚‚è¦‹ã‚„ã™ã•è¨­å®šã‚’é©ç”¨
    st.title("ğŸ’¬ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ã‚¿ãƒ«")
    st.caption(f"æœ€çµ‚æ›´æ–°: {datetime.now().strftime('%Y-%m-%d %H:%M')}")

    st.markdown("#### æ“ä½œã‚’é¸æŠã—ã¦ãã ã•ã„")
    # å¤§ãã‚ãƒœã‚¿ãƒ³ã®æ¨ªä¸¦ã³
    cols = st.columns(len(PAGES))
    keys = list(PAGES.keys())
    for col, label in zip(cols, keys):
        with col:
            if st.button(label, use_container_width=True):
                st.session_state["user_page"] = label

    st.divider()

    # ç¾åœ¨ã®ãƒšãƒ¼ã‚¸
    current = st.session_state.get("user_page", keys[0])
    st.markdown(f"### {current}")

    # å‹•çš„èª­ã¿è¾¼ã¿ã—ã¦ render() å®Ÿè¡Œ
    try:
        mod = importlib.import_module(PAGES[current])
        if hasattr(mod, "render"):
            mod.render()
        else:
            st.error("render() ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
    except Exception as e:
        st.error(f"ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")

if __name__ == "__main__":
    main()
